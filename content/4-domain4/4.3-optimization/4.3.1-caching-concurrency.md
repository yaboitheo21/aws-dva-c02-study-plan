---
title: "4.3.1-4.3.9 Concurrency, Caching, Performance"
date: 2025-02-11
weight: 1
---

## Lambda Concurrency

| Type | Mô tả | Cold Start |
|------|--------|------------|
| Unreserved | Shared pool | Yes |
| Reserved | Guaranteed + capped | Yes |
| Provisioned | Pre-initialized | **No** |

- Account default: 1000 concurrent executions
- Reserved = 0 → function disabled
- Throttling → 429 TooManyRequestsException

## Caching

### Caching Strategies

| Strategy | Pros | Cons |
|----------|------|------|
| Lazy Loading | Only cache what's needed | Cache miss penalty, stale data |
| Write-Through | Always fresh | Write penalty, cache churn |
| TTL | Balance freshness vs performance | May serve stale data |

### CloudFront Caching
- Cache key: Headers, Query Strings, Cookies
- Cache policies: CachingOptimized, CachingDisabled, Custom
- More headers in cache key = lower hit ratio

### API Gateway Caching
- Stage-level, TTL 0-3600s (default 300)
- Cache capacity: 0.5GB → 237GB
- Per-key invalidation

### SNS Filter Policies
- Filter at subscription level → reduce unnecessary processing
```json
{
  "eventType": ["order_placed"],
  "amount": [{"numeric": [">=", 100]}]
}
```

## Performance Optimization

### Lambda Best Practices
- Init SDK clients outside handler (reuse)
- Minimize package size
- Use /tmp for temp files (10GB)
- Connection reuse: `keep-alive`

### Lambda REPORT Line
```
REPORT RequestId: xxx Duration: 250ms Billed Duration: 300ms
Memory Size: 256MB Max Memory Used: 128MB Init Duration: 500ms
```
- Max Memory Used gần Memory Size → tăng memory
- Init Duration > 0 → cold start

### DynamoDB Optimization
- Batch operations: BatchWriteItem, BatchGetItem
- On-demand vs Provisioned: Match workload
- Auto Scaling cho provisioned

### S3 Optimization
- Multipart upload (> 100MB)
- Transfer Acceleration (cross-region)
- Byte-range fetches (partial reads)
- S3 Select (query in-place)

{{% notice tip %}}
**Exam Tip:** Lambda Power Tuning tool giúp tìm optimal memory. Tăng memory = tăng CPU = có thể giảm duration = có thể giảm cost.
{{% /notice %}}
