---
title: "3.2-3.3 SAM Local, IaC, Environments"
date: 2025-02-11
weight: 1
---

## SAM CLI Testing

| Command | Mô tả |
|---------|--------|
| `sam local invoke` | Run Lambda locally |
| `sam local start-api` | Local API Gateway |
| `sam local generate-event` | Generate sample events |
| `sam local start-lambda` | Local Lambda endpoint |

## Infrastructure as Code

### CloudFormation vs SAM vs CDK

| | CloudFormation | SAM | CDK |
|---|---|---|---|
| Format | YAML/JSON | YAML (extended CF) | Programming language |
| Scope | All AWS resources | Serverless focused | All AWS resources |
| Key feature | Full control | Simplified serverless | Constructs, L1/L2/L3 |
| Deploy | `aws cloudformation deploy` | `sam deploy` | `cdk deploy` |

### CloudFormation Key Sections
- **Parameters**: Input values
- **Mappings**: Static key-value lookup
- **Conditions**: Conditional resource creation
- **Resources**: AWS resources (REQUIRED)
- **Outputs**: Export values

### Intrinsic Functions
- `!Ref` — Reference parameter/resource
- `!Sub` — String substitution
- `!GetAtt` — Get resource attribute
- `!Join` — Join strings
- `!Select` — Select from list
- `!If` — Conditional value

## Multi-Environment Management

### API Gateway Stages
- Stages: dev, staging, prod
- Stage variables: Key-value per stage
- Canary: % traffic to new deployment

### Lambda Aliases
- `dev` → $LATEST
- `prod` → version 5
- Traffic shifting between versions

{{% notice tip %}}
**Exam Tip:** SAM = CloudFormation + serverless shortcuts. CDK = Programming language → CloudFormation template.
{{% /notice %}}
